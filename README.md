# Prolongation-analysis

–ü—Ä–∏–≤–µ—Ç! –¢—É—Ç —è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é –ø—Ä–æ–≥—Ä–∞–º–º—É, —Ä–µ—à–∞—é –∑–∞–¥–∞—á—É –ø–æ —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –æ –ø—Ä–æ–ª–æ–Ω–≥–∞—Ü–∏–∏ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤. –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞!üòâ

![](https://media1.tenor.com/m/3BsGAeAG7R4AAAAd/confused-thinking.gif)

### –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏
---

–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –æ—Ç–¥–µ–ª–∞ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ —Ö–æ—á–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–º, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –µ–≥–æ –æ—Ç–¥–µ–ª–∞ (–∞–∫–∫–∞—É–Ω—Ç-–º–µ–Ω–µ–¥–∂–µ—Ä—ã) —Å–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Å –æ–¥–Ω–æ–π –∏–∑ —Å–≤–æ–∏—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö –∑–∞–¥–∞—á ‚Äì –ø—Ä–æ–ª–æ–Ω–≥–∞—Ü–∏–µ–π –¥–æ–≥–æ–≤–æ—Ä–æ–≤ —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏. –û—Ç –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –æ–Ω —Ö–æ—á–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –æ—Ç—á–µ—Ç –æ –ø—Ä–æ–ª–æ–Ω–≥–∞—Ü–∏—è—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∑–∞ 2023 –≥–æ–¥. 

–í –∫–æ–º–ø–∞–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–≤–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –ø—Ä–æ–ª–æ–Ω–≥–∞—Ü–∏–∏:
–î–ª—è –ø—Ä–æ–µ–∫—Ç–æ–≤ –ø—Ä–æ–ª–æ–Ω–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤ –ø–µ—Ä–≤—ã–π –º–µ—Å—è—Ü ‚Äì –æ—Ç–Ω–æ—à–µ–Ω–∏–∏ —Å—É–º–º—ã –æ—Ç–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤ –ø—Ä–æ–ª–æ–Ω–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤ –ø–µ—Ä–≤—ã–π –º–µ—Å—è—Ü –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∫ —Å—É–º–º–µ –æ—Ç–≥—Ä—É–∑–∫–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –º–µ—Å—è—Ü–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≤—Å–µ—Ö –∑–∞–≤–µ—Ä—à–∏–≤—à–∏—Ö—Å—è –≤ –ø—Ä–æ—à–ª–æ–º –º–µ—Å—è—Ü–µ –ø—Ä–æ–µ–∫—Ç–æ–≤.
–î–ª—è –ø—Ä–æ–µ–∫—Ç–æ–≤, –ø—Ä–æ–ª–æ–Ω–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤–æ –≤—Ç–æ—Ä–æ–π –º–µ—Å—è—Ü ‚Äì –æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—É–º–º—ã –æ—Ç–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤, –ø—Ä–æ–ª–æ–Ω–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤–æ –≤—Ç–æ—Ä–æ–π –º–µ—Å—è—Ü –∫ —Å—É–º–º–µ –æ—Ç–≥—Ä—É–∑–∫–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –º–µ—Å—è—Ü–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤, –Ω–µ –ø—Ä–æ–ª–æ–Ω–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤ –ø–µ—Ä–≤—ã–π. 

–¢–æ –µ—Å—Ç—å, –µ—Å–ª–∏ –Ω–∞–º –Ω—É–∂–Ω–æ –ø–æ–Ω—è—Ç—å, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ –º–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–æ–ª–æ–Ω–≥–∏—Ä–æ–≤–∞–ª –≤ –º–∞–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å:
–°—É–º–º—É –æ—Ç–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤, –∑–∞–≤–µ—Ä—à–∏–≤—à–∏—Ö—Å—è –≤ –∞–ø—Ä–µ–ª–µ (–∑–∞ –∞–ø—Ä–µ–ª—å) –∏ —Å—É–º–º—É –æ—Ç–≥—Ä—É–∑–∫–∏ —Ç–µ—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ –∑–∞–≤–µ—Ä—à–∏–≤—à–∏—Ö—Å—è –≤ –∞–ø—Ä–µ–ª–µ, —É –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å –æ—Ç–≥—Ä—É–∑–∫–∞ –≤ –º–∞–µ (–∑–∞ –º–∞–π). –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç ‚Äì –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –≤—Ç–æ—Ä–æ–π —Å—É–º–º—ã –∫ –ø–µ—Ä–≤–æ–π. 
–°—É–º–º—É –ø—Ä–æ–µ–∫—Ç–æ–≤, –∑–∞–≤–µ—Ä—à–∏–≤—à–∏—Ö—Å—è –≤ –º–∞—Ä—Ç–µ, —É –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –æ—Ç–≥—Ä—É–∑–∫–∏ –≤ –∞–ø—Ä–µ–ª–µ (–∑–∞ –º–∞—Ä—Ç) –∏ —Å—É–º–º—É –æ—Ç–≥—Ä—É–∑–∫–∏ —Ç–µ—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤, –∑–∞–≤–µ—Ä—à–∏–≤—à–∏—Ö—Å—è –≤ –º–∞—Ä—Ç–µ, —É –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –æ—Ç–≥—Ä—É–∑–∫–∏ –≤ –∞–ø—Ä–µ–ª–µ –Ω–æ –µ—Å—Ç—å –≤ –º–∞–µ (–∑–∞ –º–∞–π). –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç ‚Äì –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –≤—Ç–æ—Ä–æ–π —Å—É–º–º—ã –∫ –ø–µ—Ä–≤–æ–π. 

–ò–º–µ—é—Ç—Å—è –¥–≤–∞ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:

prolongations.csv
- id ‚Äì id –ø—Ä–æ–µ–∫—Ç–∞
- month ‚Äì –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Å—è—Ü —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞
- AM ‚Äì –§–ò–û –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç-–º–µ–Ω–µ–¥–∂–µ—Ä–∞ (–¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–≤–∏—á–Ω—ã –ø–æ –æ—Ç–Ω–æ—à–µ–Ω–∏—é –∫ financial_data)

financial_data.csv:
- id ‚Äì id –ø—Ä–æ–µ–∫—Ç–∞
- –ü—Ä–∏—á–∏–Ω–∞ –¥—É–±–ª—è ‚Äì –ø—Ä–∏—á–∏–Ω–∞, –ø–æ—á–µ–º—É —Å—Ç—Ä–æ–∫–∏ —Å –æ–¥–Ω–∏–º –∏ —Ç–µ–º –∂–µ id –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑
- –ö–æ–ª–æ–Ω–∫–∏ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –º–µ—Å—è—Ü–∞ ‚Äì —Å—É–º–º–∞ –æ—Ç–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞ –≤ –¥–∞–Ω–Ω—ã–π –º–µ—Å—è—Ü
- Account ‚Äì –§–ò–û –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç-–º–µ–Ω–µ–¥–∂–µ—Ä–∞

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ: 
–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –ø—Ä–æ–ª–æ–Ω–≥–∞—Ü–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –∏ –¥–ª—è –≤—Å–µ–≥–æ –æ—Ç–¥–µ–ª–∞ –≤ —Ü–µ–ª–æ–º
  - –∑–∞ –∫–∞–∂–¥—ã–π –º–µ—Å—è—Ü
  - –∑–∞ –≥–æ–¥

–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç—á–µ—Ç –≤ –≥—É–≥–ª-—Ç–∞–±–ª–∏—Ü–∞—Ö –∏–ª–∏ excel, –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –∫–æ—Ç–æ—Ä–æ–≥–æ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –æ—Ç–¥–µ–ª–∞ –±—É–¥–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –ø—Ä–æ–ª–æ–Ω–≥–∞—Ü–∏–∏, –≤ –æ—Å—Ç–∞–ª—å–Ω–æ–º –æ—Ç—á–µ—Ç –º–æ–∂–Ω–æ –¥–æ–ø–æ–ª–Ω–∏—Ç—å –Ω–∞ —Å–≤–æ–µ —É—Å–º–æ—Ç—Ä–µ–Ω–∏–µ ‚Äì –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è)

`–ü—Ä–æ–ª–æ–Ω–≥–∞—Ü–∏—è` ‚Äî —ç—Ç–æ –ø–æ —Å—É—Ç–∏ –ø—Ä–æ–¥–ª–µ–Ω–∏–µ –¥–æ–≥–æ–≤–æ—Ä–∞ —Å –∫–ª–∏–µ–Ω—Ç–æ–º. –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ, —á—Ç–æ —á–µ–º –±–æ–ª—å—à–µ –ø—Ä–æ–¥–ª–µ–Ω–∏–π –¥–æ–≥–æ–≤–æ—Ä–æ–≤ —É –º–µ–Ω–µ–¥–∂–µ—Ä–∞, —Ç–µ–º –æ–Ω –ª—É—á—à–µ. –ù–æ –Ω–µ –≤—Å—ë —Ç–∞–∫ –ø—Ä–æ—Å—Ç–æ. –î–ª—è —ç—Ç–æ–≥–æ –≤ –∑–∞–¥–∞–Ω–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–≤–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞. –ò—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –æ–ø–∏—Å–∞–Ω—ã –≤—ã—à–µ, –Ω–æ –ø–æ—è—Å–Ω—é –µ—â–µ —Ä–∞–∑. 

–ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º, —á—Ç–æ –ø–µ—Ä–≤—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç ‚Äî K1. –í K1 –µ—Å—Ç—å –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å –∏ —á–∏—Å–ª–∏—Ç–µ–ª—å. `–ó–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å` ‚Äî –æ—Ç–≥—Ä—É–∑–∫–∞ –∑–∞ –º–µ—Å—è—Ü –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è. –ù–∞–ø—Ä–∏–º–µ—Ä, –º–µ—Å—è—Ü –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è ‚Äî –º–∞–π, —Ç–æ –±–µ—Ä–µ–º –º–∞–π. 
`–ß–∏—Å–ª–∏—Ç–µ–ª—å` ‚Äî –æ—Ç–≥—Ä—É–∑–∫–∞ —ç—Ç–æ–≥–æ –∂–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–º –º–µ—Å—è—Ü–µ. –ù–∞–ø—Ä–∏–º–µ—Ä, –≤ –∏—é–Ω–µ.

–û–¥–Ω–∞–∫–æ —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∫ –∑–∞–¥–∞—á–µ –¥–æ–±–∞–≤–ª—è–µ—Ç –µ—â–µ —Ç–æ, —á—Ç–æ –≤ —Ç–∞–±–ª–∏—Ü–µ —Å –æ—Ç–≥—Ä—É–∑–∫–∞–º–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è `—Å—Ç–æ–ø` –∏–ª–∏ `end` ‚Äî —Ç–∞–∫–∏–µ –ø—Ä–æ–µ–∫—Ç—ã –º—ã –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º. –¢–∞–∫–∂–µ –º–æ–∂–µ—Ç –±—ã—Ç—å `–≤ –Ω–æ–ª—å` ‚Äî –æ—Ç–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –≤ –¥–∞–Ω–Ω–æ–º –º–µ—Å—è—Ü–µ —Ä–∞–≤–Ω–∞ 0, –∑–Ω–∞—á–∏—Ç –¥–ª—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –ø—Ä–æ–ª–æ–Ω–≥–∞—Ü–∏–∏ –Ω—É–∂–Ω–æ –≤–∑—è—Ç—å –æ—Ç–≥—Ä—É–∑–∫—É –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤—Å–µ —á–∞—Å—Ç–∏ –æ–ø–ª–∞—Ç—ã —Ä–∞–≤–Ω—ã 0).

–¢–µ–ø–µ—Ä—å –≤—Ç–æ—Ä–æ–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç ‚Äî K2. 

`–ó–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å` ‚Äî –æ—Ç–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–≤–µ—Ä—à–∏–ª–∏—Å—å –¥–≤–∞ –º–µ—Å—è—Ü–∞ –Ω–∞–∑–∞–¥. –ù–∞–ø—Ä–∏–º–µ—Ä, –≤ —Ñ–µ–≤—Ä–∞–ª–µ. 
`–ß–∏—Å–ª–∏—Ç–µ–ª—å` ‚Äî –æ—Ç–≥—Ä—É–∑–∫–∞ —ç—Ç–∏—Ö –∂–µ –ø—Ä–æ–µ–∫—Ç–æ–≤ —á–µ—Ä–µ–∑ –¥–≤–∞ –º–µ—Å—è—Ü–∞. –ù–æ —ç—Ç–æ –ø—Ä–∏ —É—Å–ª–æ–≤–∏–∏, —á—Ç–æ –≤ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–º –º–µ—Å—è—Ü–µ –Ω–µ –±—ã–ª–æ –æ—Ç–≥—Ä—É–∑–∫–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –º—ã —Å–º–æ—Ç—Ä–∏–º –∞–ø—Ä–µ–ª—å, —Ç–æ –≤ –º–∞–µ –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Ç–≥—Ä—É–∑–∫–∏, –Ω–æ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ –∏—é–Ω–µ. 

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∏ –ø–µ—Ä–µ–π—Ç–∏ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.

### –û–±—â–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º
---

–ü–µ—Ä–µ–¥ —Ç–µ–º –∫–∞–∫ –≤–æ–æ–±—â–µ –ø–∏—Å–∞—Ç—å –∫–æ–¥, –Ω–∞–¥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö.

1) –ò–º–ø–æ—Ä—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫
2) –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ñ–∞–π–ª–æ–≤
3) –°–ª–∏—è–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
4) –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤
5) –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –æ—Ç—á–µ—Ç—ã

–û–¥–Ω–∞–∫–æ –ø—É–Ω–∫—Ç 4 –∏–º–µ–µ—Ç —Å–≤–æ–∏ –Ω—é–∞–Ω—Å—ã. –î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ: 
  - –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ø–∞—Ä—Å–∏—Ç—å —á–∏—Å–ª–∞. –í —Ç–∞–±–ª–∏—Ü–µ –æ–Ω–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –Ω–µ –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, –º–æ–≥—É—Ç –±—ã—Ç—å —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –∑–∞–ø—è—Ç–æ–π –≤–º–µ—Å—Ç–æ —Ç–æ—á–∫–∏.
  - –ü–µ—Ä–µ—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –º–µ—Å—è—Ü–∏ –≤ —É–¥–æ–±–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç datetime –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å–æ—Å–µ–¥–Ω–∏—Ö –º–µ—Å—è—Ü–µ–≤.
  - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–Ω–∞—á–µ–Ω–∏–π: `–≤ –Ω–æ–ª—å`, `—Å—Ç–æ–ø`, `end`

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.

### –ò–º–ø–æ—Ä—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫
---

–ü–æ–¥–∫–ª—é—á–∏–º –≤—Å–µ –Ω—É–∂–Ω—ã–µ –Ω–∞–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã.
```
import pandas as pd
from datetime import datetime
from dateutil.relativedelta import relativedelta
```

`pandas` ‚Äî —ç—Ç–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –æ—Å–Ω–æ–≤–∞ –¥–ª—è —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö. –û–Ω–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤ —Å–µ–±–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü csv –≤ —Ñ–æ—Ä–º–∞—Ç Data Frame, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª—å—à–æ–π –Ω–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, —É–¥–∞–ª–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ –ø–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º—É —É—Å–ª–æ–≤–∏—é. –ò–ª–∏ –∂–µ –æ—á–∏—Å—Ç–∫–∞ –æ—Ç –∑–Ω–∞—á–µ–Ω–∏—è "NaN". 

`datetime` –∏ `relativedelta` ‚Äî —ç—Ç–æ –¥–≤–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞—Ç. –¢—É—Ç –æ–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—å—Å—è –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å–æ—Å–µ–¥–Ω–∏—Ö –º–µ—Å—è—Ü–µ–≤. 

### –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
---
```
df_financial = pd.read_csv('financial_data.csv')
df_prolong = pd.read_csv('prolongations.csv')
```
–¢—É—Ç –º—ã —Å—á–∏—Ç—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç Data Frame –∏–∑ —Ñ–∞–π–ª–æ–≤ `financial_data.csv` –∏ `prolongations.csv` –≤ `df_financial` –∏ `df_prolong ` —Å–æ–æ—Ç–≤–µ—Å—Ç–≤–µ–Ω–Ω–æ.

### –ü–∞—Ä—Å–µ—Ä —á–∏—Å–µ–ª –æ—Ç–≥—Ä—É–∑–∫–∏
---

–ö–∞–∫ —è —É–∂–µ –ø–∏—Å–∞–ª –≤—ã—à–µ, –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–∏–≤–µ—Å—Ç–∏ —á–∏—Å–ª–∞ –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤–∏–¥. –¢–∞–∫–∂–µ –º—ã –º–æ–∂–µ–º —á–∞—Å—Ç–∏—á–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è `—Å—Ç–æ–ø`, `end` –∏ `–≤ –Ω–æ–ª—å`.

```
def parse_number(x):
    if isinstance(x, str):
        x = x.strip().lower()
        if x in ['—Å—Ç–æ–ø', 'end']:
            return '—Å—Ç–æ–ø'
        if x in ['–≤ –Ω–æ–ª—å']:
            return '–≤ –Ω–æ–ª—å'
        x = x.replace(',', '.')
        try:
            return float(x)
        except:
            return 0
    elif pd.isna(x):
        return 0
    return x
```

–§—É–Ω–∫—Ü–∏—è `isinstance` ‚Äî —ç—Ç–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è Python, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–∑–Ω–∞—Ç—å, –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –ª–∏ –æ–±—ä–µ–∫—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º—É —Ç–∏–ø—É –¥–∞–Ω–Ω—ã—Ö. –ò –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ `instance(x, str)` –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ x ‚Äî —ç—Ç–æ —Ç–∏–ø str.

–î–∞–ª–µ–µ –ø—Ä–∏–≤–æ–¥–∏–º `x` –∫ –µ–¥–∏–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É, —É–¥–∞–ª—è—è –≤—Å–µ –ø—Ä–æ–±–µ–ª—ã –ø–æ –∫—Ä–∞—è–º –∏ –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π –¥–µ–ª–∞–µ–º –≤—Å–µ —Å–∏–º–≤–æ–ª—ã —Å—Ç—Ä–æ—á–Ω—ã–º–∏. –•–æ—Ç—è –∏ –ø–æ –∑–∞–¥–∞–Ω–∏—é —Ç–∞–º –∏ –Ω–µ—Ç –∑–∞–≥–ª–∞–≤–Ω—ã—Ö –±—É–∫–≤, –Ω–æ –Ω–∞–º –Ω–∏—á–µ–≥–æ –∏ –Ω–µ –º–µ—à–∞–µ—Ç —Å–¥–µ–ª–∞—Ç—å –∏—Ö —Å—Ç—Ä–æ—á–Ω—ã–º–∏)

–ï—Å–ª–∏ –º—ã `x` –≤—Å—Ç—Ä–µ—á–∞–µ–º –∫–∞–∫ `—Å—Ç–æ–ø` –∏–ª–∏ `end`, —Ç–æ –º—ã –≤–æ–∑–≤—Ä–∞—â–∞–µ–º `—Å—Ç–æ–ø`. –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è `–≤ –Ω–æ–ª—å`. –≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –Ω–∞–º –ø—Ä–∏–≤–µ—Å—Ç–∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —É–¥–æ–±–Ω—ã–π –∏ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–ª—è –Ω–∞—Å —Ñ–æ—Ä–º–∞—Ç, —á—Ç–æ —É–º–µ–Ω—å—à–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è –æ—à–∏–±–∫–∏. –ù—É –∞ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è ‚Äî —ç—Ç–æ —á–∏—Å–ª–∞. –í –Ω–∏—Ö –º—ã –∑–∞–º–µ–Ω—è–µ–º –∑–∞–ø—è—Ç—ã–µ –Ω–∞ —Ç–æ—á–∫–∏ –∏ —É–¥–∞–ª—è–µ–º –≤—Å–µ –ø—Ä–æ–±–µ–ª—ã –≤–Ω—É—Ç—Ä–∏. –í —Å–ª—É—á–∞–µ —Ä–∞–±–æ—Ç—ã –±–µ–∑ –æ—à–∏–±–æ–∫ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö, –∏–Ω–∞—á–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –Ω–æ–ª—å. –¢–∞–∫–∂–µ –≤–µ—Ä–Ω–µ–º –Ω–æ–ª—å, –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ `NaN`. –ù–æ –µ—Å–ª–∏ —ç—Ç–æ –Ω–µ —Å—Ç—Ä–æ–∫–∞ –∏ –Ω–µ `NaN`, —Ç–æ –ø—Ä–æ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º x. 


–≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–æ —Å–≤–æ–µ–π –∑–∞–¥–∞—á–µ–π ‚Äî –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –≤—Å–µ—Ö –∑–Ω–∞—á–µ–Ω–∏–π —Ç–∞–±–ª–∏—Ü—ã –∫ –µ–¥–∏–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É. –°–∞–º–æ–µ –≥–ª–∞–≤–Ω–æ–µ ‚Äî –ø—Ä–∏–≤–æ–¥–∏—Ç —á–∏—Å–ª–∞ –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É. 

### –°–ª–∏—è–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
---

–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–¥–µ–ª–∞–µ–º –æ–±–∞ Data Frame –≤ –æ–¥–Ω—É —Ç–∞–±–ª–∏—Ü—É, –∏—Å–ø–æ–ª—å–∑—É—è `merge`.

```
merged = df_prolong.merge(df_financial, on='id', how='left')
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–µ—Å—è—Ü–µ–≤

–ö–∞–∫ —è —É–ø–æ–º—è–Ω—É–ª –≤ –Ω–∞—á–∞–ª–µ, –Ω–æ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å–æ—Å–µ–¥–Ω–∏—Ö –º–µ—Å—è—Ü–µ–≤ —Ö–æ—Ä–æ—à–æ –±—ã–ª–æ –±—ã –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —É–¥–æ–±–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É.

```
months = [
    '–Ø–Ω–≤–∞—Ä—å', '–§–µ–≤—Ä–∞–ª—å', '–ú–∞—Ä—Ç', '–ê–ø—Ä–µ–ª—å', '–ú–∞–π', '–ò—é–Ω—å',
    '–ò—é–ª—å', '–ê–≤–≥—É—Å—Ç', '–°–µ–Ω—Ç—è–±—Ä—å', '–û–∫—Ç—è–±—Ä—å', '–ù–æ—è–±—Ä—å', '–î–µ–∫–∞–±—Ä—å'
]
month_name_to_number = {name.lower(): i + 1 for i, name in enumerate(months)}
month_number_to_name = {i + 1: name for i, name in enumerate(months)}
```

`months` ‚Äî —Ç—É—Ç –ø–æ–Ω—è—Ç–Ω–æ, –ø—Ä–æ—Å—Ç–æ —Å–ø–∏—Å–æ–∫ –º–µ—Å—è—Ü–µ–≤. 

`month_name_to_number` ‚Äî —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –º–µ—Å—è—Ü –≤ —á–∏—Å–ª–æ.

`month_number_to_name` ‚Äî —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç —á–∏—Å–ª–æ –≤ –º–µ—Å—è—Ü.


# –û–±–∞–±–æ—Ç–∫–∞  –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤


```
def get_adjusted_value(row, target_month, later_months, previous_month):
    value = row.get(target_month)
    if value == '—Å—Ç–æ–ø':
        return None  # –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–æ–µ–∫—Ç—ã —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "—Å—Ç–æ–ø"
    if value == '–≤ –Ω–æ–ª—å':
        only_zeros = all(
            row.get(m, 0) in [0, '–≤ –Ω–æ–ª—å'] for m in later_months
        )
        if only_zeros:
            return row.get(previous_month, 0)
        else:
            return 0
    return value if value != '–≤ –Ω–æ–ª—å' else 0
```

`get_adjusted_value` - —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è `—Å—Ç–æ–ø` –∏ `–≤ –Ω–æ–ª—å`. –ü–æ–º–Ω–∏–º, —á—Ç–æ —Ç–∞–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –º—ã –º–æ–∂–µ–º –ø–æ–ª—É—á–∏—Ç—å –∏ `parser_number`. 
–ù–∞ –≤—Ö–æ–¥ —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç—Ä–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞:
 - `row` - —Å—Ç—Ä–æ–∫–∞ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã (Data Frame)
 - `target_noth` - —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü
 - `later_month` - –≤—Å–µ –º–µ—Å—è—Ü—ã, –∏–¥–µ—â–∏–µ –ø–æ—Å–ª–µ —Ç–µ–∫—É—â–µ–≥–æ (–Ω—É–∂–Ω–æ –¥–ª—è —Å–ª—É—á–∞–µ `–≤ –Ω–æ–ª—å`)
 - `previous_month` - –ø—Ä–µ–¥—ã–¥—É—â–∏–π –º–µ—Å—è—Ü.

–ò –µ—Å–ª–∏ –º—ã —Å—Ç—Ä–µ—á–∞–µ–º `—Å—Ç–æ–ø`, —Ç–æ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º `None`. –ï—Å–ª–∏ –≤—Å—Ç—Ä–µ—á–∞–º `–≤ –Ω–æ–ª—å`, —Ç–æ –ø—É—Ç–∏ —Ä–∞–∑–≤–µ—Ç–≤–ª—è—é—Ç—å—Å—è. `only_zeros` –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–±—Ä–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç—Ä–æ–∫–µ –≤ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –º–µ—Å—è—Ü–∞—Ö. –ï—Å–ª–∏ —Ç–∞–º –≤–µ–∑–¥–µ `0` –∏–ª–∏ `–≤ –Ω–æ–ª—å`, —Ç–æ –ø—Ä–æ–µ–∫—Ç –≤–ø–æ–ª–Ω–µ —Ä–µ–∞–ª—å–Ω–æ `–≤ –Ω–æ–ª—å`. –ï—Å–ª–∏ –æ—Ç–≥—Ä—É–∑–∫–∞ –ø–æ—à–ª–∞ –≤ –Ω–æ–ª—å, —Ç–æ –º—ã –≤–æ–∑–≤—Ä–∞—â–∞–µ–º, —á—Ç–æ–±—ã –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —ç—Ç–æ –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ –≤ –∫–æ—ç—Ñ–∏—Ü–∏–µ–Ω—Ç–µ. –ò–Ω–∞—á–µ –ø—Ä–æ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–æ–ª—å, —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç, —á—Ç–æ –æ—Ç–≥—Ä—É–∑–∫–∞ –Ω–µ —Å–æ—Å—Ç–æ—è–ª–∞—Å—å. –í–æ –≤—Å–µ—Ö –æ—Ç—Å–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö –ø—Ä–æ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ, –µ—Å–ª–∏ —ç—Ç–æ –Ω–µ `–≤ –Ω–æ–ª—å`, –∏–Ω–∞—á–µ 0. –î–∞ –¥–∞, —è –ø–æ–Ω–∏–º–∞—é, —á—Ç–æ –Ω–µ—Ç —Å–º—ã—Å–ª–∞ –ø–∏—Å–∞—Ç—å `else 0`. –ù–æ –º—ã –¥–æ–ª–∂–Ω—ã –æ–±–µ—Å–ø–µ—á–∏—Ç—å –≤ –ª—é–±–æ–º —Å–ª—É—á–∞–µ –≤–æ–∑–≤—Ä–∞—Ç –∑–Ω–∞—á–µ–Ω–∏—è. 


