# Prolongation-analysis

–ü—Ä–∏–≤–µ—Ç! –¢—É—Ç —è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é –ø—Ä–æ–≥—Ä–∞–º–º—É, —Ä–µ—à–∞—é –∑–∞–¥–∞—á—É –ø–æ —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –æ –ø—Ä–æ–ª–æ–Ω–≥–∞—Ü–∏–∏ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤. –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞!üòâ

![](https://media1.tenor.com/m/3BsGAeAG7R4AAAAd/confused-thinking.gif)

### –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏
---

–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –æ—Ç–¥–µ–ª–∞ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ —Ö–æ—á–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–º, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –µ–≥–æ –æ—Ç–¥–µ–ª–∞ (–∞–∫–∫–∞—É–Ω—Ç-–º–µ–Ω–µ–¥–∂–µ—Ä—ã) —Å–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Å –æ–¥–Ω–æ–π –∏–∑ —Å–≤–æ–∏—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö –∑–∞–¥–∞—á ‚Äì –ø—Ä–æ–ª–æ–Ω–≥–∞—Ü–∏–µ–π –¥–æ–≥–æ–≤–æ—Ä–æ–≤ —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏. –û—Ç –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –æ–Ω —Ö–æ—á–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –æ—Ç—á–µ—Ç –æ –ø—Ä–æ–ª–æ–Ω–≥–∞—Ü–∏—è—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∑–∞ 2023 –≥–æ–¥. 

–í –∫–æ–º–ø–∞–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–≤–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –ø—Ä–æ–ª–æ–Ω–≥–∞—Ü–∏–∏:
–î–ª—è –ø—Ä–æ–µ–∫—Ç–æ–≤ –ø—Ä–æ–ª–æ–Ω–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤ –ø–µ—Ä–≤—ã–π –º–µ—Å—è—Ü ‚Äì –æ—Ç–Ω–æ—à–µ–Ω–∏–∏ —Å—É–º–º—ã –æ—Ç–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤ –ø—Ä–æ–ª–æ–Ω–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤ –ø–µ—Ä–≤—ã–π –º–µ—Å—è—Ü –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∫ —Å—É–º–º–µ –æ—Ç–≥—Ä—É–∑–∫–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –º–µ—Å—è—Ü–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≤—Å–µ—Ö –∑–∞–≤–µ—Ä—à–∏–≤—à–∏—Ö—Å—è –≤ –ø—Ä–æ—à–ª–æ–º –º–µ—Å—è—Ü–µ –ø—Ä–æ–µ–∫—Ç–æ–≤.
–î–ª—è –ø—Ä–æ–µ–∫—Ç–æ–≤, –ø—Ä–æ–ª–æ–Ω–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤–æ –≤—Ç–æ—Ä–æ–π –º–µ—Å—è—Ü ‚Äì –æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—É–º–º—ã –æ—Ç–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤, –ø—Ä–æ–ª–æ–Ω–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤–æ –≤—Ç–æ—Ä–æ–π –º–µ—Å—è—Ü –∫ —Å—É–º–º–µ –æ—Ç–≥—Ä—É–∑–∫–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –º–µ—Å—è—Ü–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤, –Ω–µ –ø—Ä–æ–ª–æ–Ω–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤ –ø–µ—Ä–≤—ã–π. 

–¢–æ –µ—Å—Ç—å, –µ—Å–ª–∏ –Ω–∞–º –Ω—É–∂–Ω–æ –ø–æ–Ω—è—Ç—å, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ –º–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–æ–ª–æ–Ω–≥–∏—Ä–æ–≤–∞–ª –≤ –º–∞–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å:
–°—É–º–º—É –æ—Ç–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤, –∑–∞–≤–µ—Ä—à–∏–≤—à–∏—Ö—Å—è –≤ –∞–ø—Ä–µ–ª–µ (–∑–∞ –∞–ø—Ä–µ–ª—å) –∏ —Å—É–º–º—É –æ—Ç–≥—Ä—É–∑–∫–∏ —Ç–µ—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ –∑–∞–≤–µ—Ä—à–∏–≤—à–∏—Ö—Å—è –≤ –∞–ø—Ä–µ–ª–µ, —É –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å –æ—Ç–≥—Ä—É–∑–∫–∞ –≤ –º–∞–µ (–∑–∞ –º–∞–π). –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç ‚Äì –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –≤—Ç–æ—Ä–æ–π —Å—É–º–º—ã –∫ –ø–µ—Ä–≤–æ–π. 
–°—É–º–º—É –ø—Ä–æ–µ–∫—Ç–æ–≤, –∑–∞–≤–µ—Ä—à–∏–≤—à–∏—Ö—Å—è –≤ –º–∞—Ä—Ç–µ, —É –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –æ—Ç–≥—Ä—É–∑–∫–∏ –≤ –∞–ø—Ä–µ–ª–µ (–∑–∞ –º–∞—Ä—Ç) –∏ —Å—É–º–º—É –æ—Ç–≥—Ä—É–∑–∫–∏ —Ç–µ—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤, –∑–∞–≤–µ—Ä—à–∏–≤—à–∏—Ö—Å—è –≤ –º–∞—Ä—Ç–µ, —É –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –æ—Ç–≥—Ä—É–∑–∫–∏ –≤ –∞–ø—Ä–µ–ª–µ –Ω–æ –µ—Å—Ç—å –≤ –º–∞–µ (–∑–∞ –º–∞–π). –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç ‚Äì –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –≤—Ç–æ—Ä–æ–π —Å—É–º–º—ã –∫ –ø–µ—Ä–≤–æ–π. 

–ò–º–µ—é—Ç—Å—è –¥–≤–∞ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:

prolongations.csv
- id ‚Äì id –ø—Ä–æ–µ–∫—Ç–∞
- month ‚Äì –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Å—è—Ü —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞
- AM ‚Äì –§–ò–û –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç-–º–µ–Ω–µ–¥–∂–µ—Ä–∞ (–¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–≤–∏—á–Ω—ã –ø–æ –æ—Ç–Ω–æ—à–µ–Ω–∏—é –∫ financial_data)

financial_data.csv:
- id ‚Äì id –ø—Ä–æ–µ–∫—Ç–∞
- –ü—Ä–∏—á–∏–Ω–∞ –¥—É–±–ª—è ‚Äì –ø—Ä–∏—á–∏–Ω–∞, –ø–æ—á–µ–º—É —Å—Ç—Ä–æ–∫–∏ —Å –æ–¥–Ω–∏–º –∏ —Ç–µ–º –∂–µ id –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑
- –ö–æ–ª–æ–Ω–∫–∏ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –º–µ—Å—è—Ü–∞ ‚Äì —Å—É–º–º–∞ –æ—Ç–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞ –≤ –¥–∞–Ω–Ω—ã–π –º–µ—Å—è—Ü
- Account ‚Äì –§–ò–û –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç-–º–µ–Ω–µ–¥–∂–µ—Ä–∞

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ: 
–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –ø—Ä–æ–ª–æ–Ω–≥–∞—Ü–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –∏ –¥–ª—è –≤—Å–µ–≥–æ –æ—Ç–¥–µ–ª–∞ –≤ —Ü–µ–ª–æ–º
  - –∑–∞ –∫–∞–∂–¥—ã–π –º–µ—Å—è—Ü
  - –∑–∞ –≥–æ–¥

–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç—á–µ—Ç –≤ –≥—É–≥–ª-—Ç–∞–±–ª–∏—Ü–∞—Ö –∏–ª–∏ excel, –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –∫–æ—Ç–æ—Ä–æ–≥–æ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –æ—Ç–¥–µ–ª–∞ –±—É–¥–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –ø—Ä–æ–ª–æ–Ω–≥–∞—Ü–∏–∏, –≤ –æ—Å—Ç–∞–ª—å–Ω–æ–º –æ—Ç—á–µ—Ç –º–æ–∂–Ω–æ –¥–æ–ø–æ–ª–Ω–∏—Ç—å –Ω–∞ —Å–≤–æ–µ —É—Å–º–æ—Ç—Ä–µ–Ω–∏–µ ‚Äì –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è)

`–ü—Ä–æ–ª–æ–Ω–≥–∞—Ü–∏—è` ‚Äî —ç—Ç–æ –ø–æ —Å—É—Ç–∏ –ø—Ä–æ–¥–ª–µ–Ω–∏–µ –¥–æ–≥–æ–≤–æ—Ä–∞ —Å –∫–ª–∏–µ–Ω—Ç–æ–º. –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ, —á—Ç–æ —á–µ–º –±–æ–ª—å—à–µ –ø—Ä–æ–¥–ª–µ–Ω–∏–π –¥–æ–≥–æ–≤–æ—Ä–æ–≤ —É –º–µ–Ω–µ–¥–∂–µ—Ä–∞, —Ç–µ–º –æ–Ω –ª—É—á—à–µ. –ù–æ –Ω–µ –≤—Å—ë —Ç–∞–∫ –ø—Ä–æ—Å—Ç–æ. –î–ª—è —ç—Ç–æ–≥–æ –≤ –∑–∞–¥–∞–Ω–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–≤–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞. –ò—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –æ–ø–∏—Å–∞–Ω—ã –≤—ã—à–µ, –Ω–æ –ø–æ—è—Å–Ω—é –µ—â–µ —Ä–∞–∑. 

–ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º, —á—Ç–æ –ø–µ—Ä–≤—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç ‚Äî K1. –í K1 –µ—Å—Ç—å –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å –∏ —á–∏—Å–ª–∏—Ç–µ–ª—å. `–ó–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å` ‚Äî –æ—Ç–≥—Ä—É–∑–∫–∞ –∑–∞ –º–µ—Å—è—Ü –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è. –ù–∞–ø—Ä–∏–º–µ—Ä, –º–µ—Å—è—Ü –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è ‚Äî –º–∞–π, —Ç–æ –±–µ—Ä–µ–º –º–∞–π. 
`–ß–∏—Å–ª–∏—Ç–µ–ª—å` ‚Äî –æ—Ç–≥—Ä—É–∑–∫–∞ —ç—Ç–æ–≥–æ –∂–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–º –º–µ—Å—è—Ü–µ. –ù–∞–ø—Ä–∏–º–µ—Ä, –≤ –∏—é–Ω–µ.

–û–¥–Ω–∞–∫–æ —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∫ –∑–∞–¥–∞—á–µ –¥–æ–±–∞–≤–ª—è–µ—Ç –µ—â–µ —Ç–æ, —á—Ç–æ –≤ —Ç–∞–±–ª–∏—Ü–µ —Å –æ—Ç–≥—Ä—É–∑–∫–∞–º–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è `—Å—Ç–æ–ø` –∏–ª–∏ `end` ‚Äî —Ç–∞–∫–∏–µ –ø—Ä–æ–µ–∫—Ç—ã –º—ã –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º. –¢–∞–∫–∂–µ –º–æ–∂–µ—Ç –±—ã—Ç—å `–≤ –Ω–æ–ª—å` ‚Äî –æ—Ç–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –≤ –¥–∞–Ω–Ω–æ–º –º–µ—Å—è—Ü–µ —Ä–∞–≤–Ω–∞ 0, –∑–Ω–∞—á–∏—Ç –¥–ª—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –ø—Ä–æ–ª–æ–Ω–≥–∞—Ü–∏–∏ –Ω—É–∂–Ω–æ –≤–∑—è—Ç—å –æ—Ç–≥—Ä—É–∑–∫—É –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤—Å–µ —á–∞—Å—Ç–∏ –æ–ø–ª–∞—Ç—ã —Ä–∞–≤–Ω—ã 0).

–¢–µ–ø–µ—Ä—å –≤—Ç–æ—Ä–æ–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç ‚Äî K2. 

`–ó–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å` ‚Äî –æ—Ç–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–≤–µ—Ä—à–∏–ª–∏—Å—å –¥–≤–∞ –º–µ—Å—è—Ü–∞ –Ω–∞–∑–∞–¥. –ù–∞–ø—Ä–∏–º–µ—Ä, –≤ —Ñ–µ–≤—Ä–∞–ª–µ. 
`–ß–∏—Å–ª–∏—Ç–µ–ª—å` ‚Äî –æ—Ç–≥—Ä—É–∑–∫–∞ —ç—Ç–∏—Ö –∂–µ –ø—Ä–æ–µ–∫—Ç–æ–≤ —á–µ—Ä–µ–∑ –¥–≤–∞ –º–µ—Å—è—Ü–∞. –ù–æ —ç—Ç–æ –ø—Ä–∏ —É—Å–ª–æ–≤–∏–∏, —á—Ç–æ –≤ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–º –º–µ—Å—è—Ü–µ –Ω–µ –±—ã–ª–æ –æ—Ç–≥—Ä—É–∑–∫–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –º—ã —Å–º–æ—Ç—Ä–∏–º –∞–ø—Ä–µ–ª—å, —Ç–æ –≤ –º–∞–µ –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Ç–≥—Ä—É–∑–∫–∏, –Ω–æ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ –∏—é–Ω–µ. 

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∏ –ø–µ—Ä–µ–π—Ç–∏ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.

### –û–±—â–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º
---

–ü–µ—Ä–µ–¥ —Ç–µ–º –∫–∞–∫ –≤–æ–æ–±—â–µ –ø–∏—Å–∞—Ç—å –∫–æ–¥, –Ω–∞–¥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö.

1) –ò–º–ø–æ—Ä—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫
2) –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ñ–∞–π–ª–æ–≤
3) –°–ª–∏—è–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
4) –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤
5) –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –æ—Ç—á–µ—Ç—ã

–û–¥–Ω–∞–∫–æ –ø—É–Ω–∫—Ç 4 –∏–º–µ–µ—Ç —Å–≤–æ–∏ –Ω—é–∞–Ω—Å—ã. –î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ: 
  - –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ø–∞—Ä—Å–∏—Ç—å —á–∏—Å–ª–∞. –í —Ç–∞–±–ª–∏—Ü–µ –æ–Ω–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –Ω–µ –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, –º–æ–≥—É—Ç –±—ã—Ç—å —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –∑–∞–ø—è—Ç–æ–π –≤–º–µ—Å—Ç–æ —Ç–æ—á–∫–∏.
  - –ü–µ—Ä–µ—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –º–µ—Å—è—Ü–∏ –≤ —É–¥–æ–±–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç datetime –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å–æ—Å–µ–¥–Ω–∏—Ö –º–µ—Å—è—Ü–µ–≤.
  - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–Ω–∞—á–µ–Ω–∏–π: `–≤ –Ω–æ–ª—å`, `—Å—Ç–æ–ø`, `end`

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.

### –ò–º–ø–æ—Ä—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫
---

–ü–æ–¥–∫–ª—é—á–∏–º –≤—Å–µ –Ω—É–∂–Ω—ã–µ –Ω–∞–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã.
```
import pandas as pd
import re
from datetime import datetime
from dateutil.relativedelta import relativedelta
```

`pandas` ‚Äî —ç—Ç–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –æ—Å–Ω–æ–≤–∞ –¥–ª—è —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö. –û–Ω–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤ —Å–µ–±–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü csv –≤ —Ñ–æ—Ä–º–∞—Ç Data Frame, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª—å—à–æ–π –Ω–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, —É–¥–∞–ª–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ –ø–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º—É —É—Å–ª–æ–≤–∏—é. –ò–ª–∏ –∂–µ –æ—á–∏—Å—Ç–∫–∞ –æ—Ç –∑–Ω–∞—á–µ–Ω–∏—è "NaN". 

`datetime` –∏ `relativedelta` ‚Äî —ç—Ç–æ –¥–≤–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞—Ç. –¢—É—Ç –æ–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—å—Å—è –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å–æ—Å–µ–¥–Ω–∏—Ö –º–µ—Å—è—Ü–µ–≤. 

`re` - –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–µ–Ω–∏—è —Å–ª–æ–≤ –ø–æ –º–∞—Å–∫–µ

### –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
---
```
df_financial = pd.read_csv('financial_data.csv')
df_prolong = pd.read_csv('prolongations.csv')
```
–¢—É—Ç –º—ã —Å—á–∏—Ç—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç Data Frame –∏–∑ —Ñ–∞–π–ª–æ–≤ `financial_data.csv` –∏ `prolongations.csv` –≤ `df_financial` –∏ `df_prolong ` —Å–æ–æ—Ç–≤–µ—Å—Ç–≤–µ–Ω–Ω–æ.

### –ü–∞—Ä—Å–µ—Ä —á–∏—Å–µ–ª –æ—Ç–≥—Ä—É–∑–∫–∏
---

–ö–∞–∫ —è —É–∂–µ –ø–∏—Å–∞–ª –≤—ã—à–µ, –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–∏–≤–µ—Å—Ç–∏ —á–∏—Å–ª–∞ –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤–∏–¥. –¢–∞–∫–∂–µ –º—ã –º–æ–∂–µ–º —á–∞—Å—Ç–∏—á–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è `—Å—Ç–æ–ø`, `end` –∏ `–≤ –Ω–æ–ª—å`.

```
def parse_number(x):
    if isinstance(x, str):
        x = x.strip().lower()
        if x in ['—Å—Ç–æ–ø', 'end']:
            return '—Å—Ç–æ–ø'
        if x in ['–≤ –Ω–æ–ª—å']:
            return '–≤ –Ω–æ–ª—å'
        x = x.replace(',', '.')
        try:
            return float(x)
        except:
            return 0
    elif pd.isna(x):
        return 0
    return x
```

–§—É–Ω–∫—Ü–∏—è `isinstance` ‚Äî —ç—Ç–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è Python, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–∑–Ω–∞—Ç—å, –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –ª–∏ –æ–±—ä–µ–∫—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º—É —Ç–∏–ø—É –¥–∞–Ω–Ω—ã—Ö. –ò –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ `instance(x, str)` –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ x ‚Äî —ç—Ç–æ —Ç–∏–ø str.

–î–∞–ª–µ–µ –ø—Ä–∏–≤–æ–¥–∏–º `x` –∫ –µ–¥–∏–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É, —É–¥–∞–ª—è—è –≤—Å–µ –ø—Ä–æ–±–µ–ª—ã –ø–æ –∫—Ä–∞—è–º –∏ –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π –¥–µ–ª–∞–µ–º –≤—Å–µ —Å–∏–º–≤–æ–ª—ã —Å—Ç—Ä–æ—á–Ω—ã–º–∏. –•–æ—Ç—è –∏ –ø–æ –∑–∞–¥–∞–Ω–∏—é —Ç–∞–º –∏ –Ω–µ—Ç –∑–∞–≥–ª–∞–≤–Ω—ã—Ö –±—É–∫–≤, –Ω–æ –Ω–∞–º –Ω–∏—á–µ–≥–æ –∏ –Ω–µ –º–µ—à–∞–µ—Ç —Å–¥–µ–ª–∞—Ç—å –∏—Ö —Å—Ç—Ä–æ—á–Ω—ã–º–∏)

–ï—Å–ª–∏ –º—ã `x` –≤—Å—Ç—Ä–µ—á–∞–µ–º –∫–∞–∫ `—Å—Ç–æ–ø` –∏–ª–∏ `end`, —Ç–æ –º—ã –≤–æ–∑–≤—Ä–∞—â–∞–µ–º `—Å—Ç–æ–ø`. –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è `–≤ –Ω–æ–ª—å`. –≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –Ω–∞–º –ø—Ä–∏–≤–µ—Å—Ç–∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —É–¥–æ–±–Ω—ã–π –∏ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–ª—è –Ω–∞—Å —Ñ–æ—Ä–º–∞—Ç, —á—Ç–æ —É–º–µ–Ω—å—à–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è –æ—à–∏–±–∫–∏. –ù—É –∞ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è ‚Äî —ç—Ç–æ —á–∏—Å–ª–∞. –í –Ω–∏—Ö –º—ã –∑–∞–º–µ–Ω—è–µ–º –∑–∞–ø—è—Ç—ã–µ –Ω–∞ —Ç–æ—á–∫–∏ –∏ —É–¥–∞–ª—è–µ–º –≤—Å–µ –ø—Ä–æ–±–µ–ª—ã –≤–Ω—É—Ç—Ä–∏. –í —Å–ª—É—á–∞–µ —Ä–∞–±–æ—Ç—ã –±–µ–∑ –æ—à–∏–±–æ–∫ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö, –∏–Ω–∞—á–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –Ω–æ–ª—å. –¢–∞–∫–∂–µ –≤–µ—Ä–Ω–µ–º –Ω–æ–ª—å, –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ `NaN`. –ù–æ –µ—Å–ª–∏ —ç—Ç–æ –Ω–µ —Å—Ç—Ä–æ–∫–∞ –∏ –Ω–µ `NaN`, —Ç–æ –ø—Ä–æ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º x. 


–≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–æ —Å–≤–æ–µ–π –∑–∞–¥–∞—á–µ–π ‚Äî –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –≤—Å–µ—Ö –∑–Ω–∞—á–µ–Ω–∏–π —Ç–∞–±–ª–∏—Ü—ã –∫ –µ–¥–∏–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É. –°–∞–º–æ–µ –≥–ª–∞–≤–Ω–æ–µ ‚Äî –ø—Ä–∏–≤–æ–¥–∏—Ç —á–∏—Å–ª–∞ –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É. 

 ### –ü–µ—Ä–µ—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∏—Å–µ–ª

 ```
month_cols = [col for col in df_financial.columns if re.match(r'[–ê-–Ø–∞-—è]+\s\d{4}', col)]
for col in month_cols:
    df_financial[col] = df_financial[col].apply(parse_number)
```
–≠—Ç–æ—Ç —É—á–∞—Å—Ç–æ–∫ –∫–æ–¥–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–º –∑–∞–ø–∞—Ä—Å–∏—Ç—å –≤—Å–µ —á–∏—Å–ª–∞.

–í `month_cols` –º—ã –ø–æ–ª–∞—á–µ–º —Å–ø–∏—Å–æ–∫ —Å—Ç–æ–±–ª—Ü–æ–≤ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –æ—Ç–≥—Ä—É–∑–∫–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, `–ê–ø—Ä–µ–ª—å 2023`.
–ê `apply` - –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–º —É Data Frame –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –∫ –∫–æ–ª–æ–Ω–∫–µ.

### –°–ª–∏—è–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
---

–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–¥–µ–ª–∞–µ–º –æ–±–∞ Data Frame –≤ –æ–¥–Ω—É —Ç–∞–±–ª–∏—Ü—É, –∏—Å–ø–æ–ª—å–∑—É—è `merge`.

```
merged = df_prolong.merge(df_financial, on='id', how='left')
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–µ—Å—è—Ü–µ–≤
---

–ö–∞–∫ —è —É–ø–æ–º—è–Ω—É–ª –≤ –Ω–∞—á–∞–ª–µ, –Ω–æ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å–æ—Å–µ–¥–Ω–∏—Ö –º–µ—Å—è—Ü–µ–≤ —Ö–æ—Ä–æ—à–æ –±—ã–ª–æ –±—ã –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —É–¥–æ–±–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É.

```
months = [
    '–Ø–Ω–≤–∞—Ä—å', '–§–µ–≤—Ä–∞–ª—å', '–ú–∞—Ä—Ç', '–ê–ø—Ä–µ–ª—å', '–ú–∞–π', '–ò—é–Ω—å',
    '–ò—é–ª—å', '–ê–≤–≥—É—Å—Ç', '–°–µ–Ω—Ç—è–±—Ä—å', '–û–∫—Ç—è–±—Ä—å', '–ù–æ—è–±—Ä—å', '–î–µ–∫–∞–±—Ä—å'
]
month_name_to_number = {name.lower(): i + 1 for i, name in enumerate(months)}
month_number_to_name = {i + 1: name for i, name in enumerate(months)}
```

`months` ‚Äî —Ç—É—Ç –ø–æ–Ω—è—Ç–Ω–æ, –ø—Ä–æ—Å—Ç–æ —Å–ø–∏—Å–æ–∫ –º–µ—Å—è—Ü–µ–≤. 

`month_name_to_number` ‚Äî —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –º–µ—Å—è—Ü –≤ —á–∏—Å–ª–æ.

`month_number_to_name` ‚Äî —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç —á–∏—Å–ª–æ –≤ –º–µ—Å—è—Ü.


### –û–±–∞–±–æ—Ç–∫–∞  –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
---


```
def get_adjusted_value(row, target_month, later_months, previous_month):
    value = row.get(target_month)
    if value == '—Å—Ç–æ–ø':
        return None  # –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–æ–µ–∫—Ç—ã —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "—Å—Ç–æ–ø"
    if value == '–≤ –Ω–æ–ª—å':
        only_zeros = all(
            row.get(m, 0) in [0, '–≤ –Ω–æ–ª—å'] for m in later_months
        )
        if only_zeros:
            return row.get(previous_month, 0)
        else:
            return 0
    return value if value != '–≤ –Ω–æ–ª—å' else 0
```

`get_adjusted_value` ‚Äî —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è `—Å—Ç–æ–ø` –∏ `–≤ –Ω–æ–ª—å`. –ü–æ–º–Ω–∏–º, —á—Ç–æ —Ç–∞–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –º—ã –º–æ–∂–µ–º –ø–æ–ª—É—á–∏—Ç—å –∏ `parser_number`. 
–ù–∞ –≤—Ö–æ–¥ —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç—Ä–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞:
- `row` ‚Äî —Å—Ç—Ä–æ–∫–∞ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã (Data Frame);
- `target_month` ‚Äî —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü;
- `later_months` ‚Äî –≤—Å–µ –º–µ—Å—è—Ü—ã, –∏–¥—É—â–∏–µ –ø–æ—Å–ª–µ —Ç–µ–∫—É—â–µ–≥–æ (–Ω—É–∂–Ω–æ –¥–ª—è —Å–ª—É—á–∞—è `–≤ –Ω–æ–ª—å`);
- `previous_month` ‚Äî –ø—Ä–µ–¥—ã–¥—É—â–∏–π –º–µ—Å—è—Ü.

–ò –µ—Å–ª–∏ –º—ã –≤—Å—Ç—Ä–µ—á–∞–µ–º `—Å—Ç–æ–ø`, —Ç–æ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º `None`. –ï—Å–ª–∏ –≤—Å—Ç—Ä–µ—á–∞–µ–º `–≤ –Ω–æ–ª—å`, —Ç–æ –ø—É—Ç–∏ —Ä–∞–∑–≤–µ—Ç–≤–ª—è—é—Ç—Å—è. `only_zeros` –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–±—Ä–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç—Ä–æ–∫–µ –≤ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –º–µ—Å—è—Ü–∞—Ö. –ï—Å–ª–∏ —Ç–∞–º –≤–µ–∑–¥–µ `0` –∏–ª–∏ `–≤ –Ω–æ–ª—å`, —Ç–æ –ø—Ä–æ–µ–∫—Ç –≤–ø–æ–ª–Ω–µ —Ä–µ–∞–ª—å–Ω–æ `–≤ –Ω–æ–ª—å`. –ï—Å–ª–∏ –æ—Ç–≥—Ä—É–∑–∫–∞ –ø–æ—à–ª–∞ –≤ –Ω–æ–ª—å, —Ç–æ –º—ã –≤–æ–∑–≤—Ä–∞—â–∞–µ–º, —á—Ç–æ–±—ã –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —ç—Ç–æ –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ –≤ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–µ. –ò–Ω–∞—á–µ –ø—Ä–æ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–æ–ª—å, —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç, —á—Ç–æ –æ—Ç–≥—Ä—É–∑–∫–∞ –Ω–µ —Å–æ—Å—Ç–æ—è–ª–∞—Å—å. –í–æ –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö –ø—Ä–æ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ, –µ—Å–ª–∏ —ç—Ç–æ –Ω–µ `–≤ –Ω–æ–ª—å`, –∏–Ω–∞—á–µ 0. –î–∞-–¥–∞, —è –ø–æ–Ω–∏–º–∞—é, —á—Ç–æ –Ω–µ—Ç —Å–º—ã—Å–ª–∞ –ø–∏—Å–∞—Ç—å `else 0`. –ù–æ –º—ã –¥–æ–ª–∂–Ω—ã –æ–±–µ—Å–ø–µ—á–∏—Ç—å –≤ –ª—é–±–æ–º —Å–ª—É—á–∞–µ –≤–æ–∑–≤—Ä–∞—Ç –∑–Ω–∞—á–µ–Ω–∏—è. 

### –†–∞—Å—á–µ—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –≤—Å–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã –≥–æ—Ç–æ–≤–æ, –ø—Ä–∏—Å—Ç—É–ø–∏–º –∫ —Å–ª–æ–∂–Ω–æ–º—É.

```


def calculate_coefficients(df, current_month):
    coefficients = []

    try:
        month_str, year_str = current_month.strip().split()
        current_dt = datetime(int(year_str), month_name_to_number[month_str.lower()], 1)
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –º–µ—Å—è—Ü–∞ {current_month}: {e}")
        return pd.DataFrame()

    # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω—É–∂–Ω—ã—Ö –º–µ—Å—è—Ü–µ–≤
    prev_dt = current_dt - relativedelta(months=1)  # –∞–ø—Ä–µ–ª—å, –µ—Å–ª–∏ —Ç–µ–∫—É—â–∏–π ‚Äî –º–∞–π
    prev2_dt = current_dt - relativedelta(months=2)  # –º–∞—Ä—Ç, –µ—Å–ª–∏ —Ç–µ–∫—É—â–∏–π ‚Äî –º–∞–π

    prev_month = f"{month_number_to_name[prev_dt.month]} {prev_dt.year}"
    prev2_month = f"{month_number_to_name[prev2_dt.month]} {prev2_dt.year}"
    current_month_str = f"{month_number_to_name[current_dt.month]} {current_dt.year}"

    later_months_from_prev = [
        f"{month_number_to_name[(prev_dt.month + i - 1) % 12 + 1]} {prev_dt.year + ((prev_dt.month + i - 1) // 12)}"
        for i in range(1, 13)
    ]
    later_months_from_prev2 = [
        f"{month_number_to_name[(prev2_dt.month + i - 1) % 12 + 1]} {prev2_dt.year + ((prev2_dt.month + i - 1) // 12)}"
        for i in range(1, 13)
    ]

    for account, group in df.groupby('Account'):
        k1_num = 0
        k1_den = 0
        k2_num = 0
        k2_den = 0

        for _, row in group.iterrows():
            # –ü—Ä–æ–ª–æ–Ω–≥–∞—Ü–∏—è –≤ 1-–π –º–µ—Å—è—Ü –ø–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è
            end_val = get_adjusted_value(row, prev_month, later_months_from_prev, '')
            next_val = get_adjusted_value(row, current_month_str, [], prev_month)
            if end_val is not None and isinstance(end_val, (int, float)) and end_val > 0:
                k1_num += next_val if isinstance(next_val, (int, float)) else 0
                k1_den += end_val

            # –ü—Ä–æ–ª–æ–Ω–≥–∞—Ü–∏—è –≤–æ 2-–π –º–µ—Å—è—Ü –ø–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è
            end2_val = get_adjusted_value(row, prev2_month, later_months_from_prev2, '')
            skip_val = get_adjusted_value(row, prev_month, later_months_from_prev, prev2_month)
            second_val = get_adjusted_value(row, current_month_str, [], prev_month)

            if end2_val is not None and isinstance(end2_val, (int, float)) and end2_val > 0 and (not skip_val or skip_val == 0):
                k2_num += second_val if isinstance(second_val, (int, float)) else 0
                k2_den += end2_val

        k1 = round(k1_num / k1_den, 2) if k1_den else None
        k2 = round(k2_num / k2_den, 2) if k2_den else None

        coefficients.append({
            'Account': account,
            'K1': k1,
            'K2': k2
        })

    return pd.DataFrame(coefficients)
```

–ù–∞ –≤—Ö–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–∏—Ö–æ–¥–∏—Ç –Ω–∞—à–∞ —Ç–∞–±–ª–∏—Ü–∞ –Ω–∞ –æ–¥–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ - `df`, –∏ `current_month` - –º–µ—Å—è—Ü, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—Ä–æ–ª–æ–Ω–≥–∞—Ü–∏—é.

–î–ª—è –Ω–∞—à–µ–≥–æ –º–µ—Å—è—Ü–∞ –º—ã –ø–∞—Ä—Å–∏–º –µ–≥–æ –æ—Ç–¥–µ–ª—å–Ω–æ –Ω–∞ –º–µ—Å—è—Ü, –æ—Ç–¥–µ–ª—å–Ω–æ –Ω–∞ –≥–æ–¥ - `month_str` –∏ `year_str`.

```
month_str, year_str = current_month.strip().split()
```

–î–∞–ª–µ–µ –º—ã –ø—Ä–∏–≤–æ–¥–∏–º –º–µ—Å—è—Ü –∏ –≥–æ–¥ –∫ —Ñ–æ—Ä–º–∞—Ç—É `datetime`, —Å–æ—Ö—Ä–∞–Ω—è—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ `current_dt` ‚Äî —á—Ç–æ –∑–Ω–∞—á–∏—Ç `current_datetime` (—Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞). –≠—Ç–æ –ø—Ä–æ—Å—Ç–æ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –Ω–∞–∑–≤–∞–Ω–∏—è üòä.
```
current_dt = datetime(int(year_str), month_name_to_number[month_str.lower()], 1)
```

–ù–æ –Ω–∞—à–∞ –æ—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å ‚Äî —Å–¥–µ–ª–∞—Ç—å –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –±—É–¥–µ—Ç –ø—Ä–µ—Ä—ã–≤–∞—Ç—å—Å—è –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏, –ø–æ—ç—Ç–æ–º—É –≤—Å—é –Ω–∞—à—É –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—é –≤ `datetime` –æ–±–æ—Ä–∞—á–∏–≤–∞–µ–º –≤ `try-except`. –í–æ—Ç –∫–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç –≤ –∏—Ç–æ–≥–æ–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ:

```
try:
        month_str, year_str = current_month.strip().split()
        current_dt = datetime(int(year_str), month_name_to_number[month_str.lower()], 1)
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –º–µ—Å—è—Ü–∞ {current_month}: {e}")
        return pd.DataFrame()
```

–î–∞–ª–µ–µ –æ–ø—Ä–µ–¥–µ–ª–∏–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –º–µ—Å—è—Ü—ã. –ü–æ—á–µ–º—É —Ç–∞–∫, –µ—Å–ª–∏ –≤ –∑–∞–¥–∞—á–µ —É –Ω–∞—Å –ø—Ä–∏–≤–æ–¥–∏—Ç—Å—è –ø—Ä–∏–º–µ—Ä, –≥–¥–µ –º—ã –±–µ—Ä–µ–º –º–µ—Å—è—Ü –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–ø—Ä–µ–ª—å, –∞ –º–µ—Å—è—Ü –æ—Ç–≥—Ä—É–∑–∫–∏ ‚Äî –º–∞–π? –¢–∞–∫ –≤—Å—ë –ø—Ä–∞–≤–∏–ª—å–Ω–æ, —è —Å–∫–∞–∂—É) –í–µ–¥—å –º—ã –±–µ—Ä–µ–º `current_dt` –∫–∞–∫ –º–µ—Å—è—Ü –æ—Ç–≥—Ä—É–∑–∫–∏, –∑–Ω–∞—á–∏—Ç –Ω–∞–º –Ω—É–∂–Ω–æ —Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞–∑–∞–¥. –ü–æ—ç—Ç–æ–º—É –º—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π –º–µ—Å—è—Ü –∏ –ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–∏–π.

```
prev_dt = current_dt - relativedelta(months=1)
prev2_dt = current_dt - relativedelta(months=2)
```

–¢–µ–ø–µ—Ä—å —É –Ω–∞—Å `prev_dt` ‚Äî —ç—Ç–æ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –º–µ—Å—è—Ü, –∞ `prev2_dt` ‚Äî –ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–∏–π. 

–ü–æ—Å–ª–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≤—Å–µ—Ö –º–µ—Å—è—Ü–µ–≤ –º—ã –ø–µ—Ä–µ–≤–æ–¥–∏–º –∏—Ö –≤ –æ–±—Ä–∞—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç. 

```
prev_month = f"{month_number_to_name[prev_dt.month]} {prev_dt.year}"
prev2_month = f"{month_number_to_name[prev2_dt.month]} {prev2_dt.year}"
current_month_str = f"{month_number_to_name[current_dt.month]} {current_dt.year}"
```

–ù–æ —Ç—É—Ç —Ö–æ—á—É —Å–¥–µ–ª–∞—Ç—å –∑–∞–º–µ—Ç–∫—É –Ω–∞—Å—á–µ—Ç `current_month_str`. –ü–æ –∏–¥–µ–µ, –¥–∞–Ω–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –±—É–¥–µ—Ç —Ä–∞–≤–Ω–∞ `current_month`. –ù–æ —è –ª–∏—á–Ω–æ –¥–µ–ª–∞—é –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∏ –Ω–∞–¥ –Ω–µ–π, —á—Ç–æ–±—ã –≤—Å–µ –º–µ—Å—è—Ü—ã —É –º–µ–Ω—è –±—ã–ª–∏ –≤ –µ–¥–∏–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ. –•–æ—Ç—è –º–æ–∂–Ω–æ –ø–æ–¥—É–º–∞—Ç—å –∏ –Ω–∞–¥ –µ–µ —É–¥–∞–ª–µ–Ω–∏–µ–º –≤ –ø—Ä–∏–Ω—Ü–∏–ø–µ. 

–¢–µ–ø–µ—Ä—å –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–∞–¥–æ –±—ã –≤—ã—á–∏—Å–ª–∏—Ç—å —Å–ø–∏—Å–æ–∫ –º–µ—Å—è—Ü–µ–≤ –¥–ª—è –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∏ –ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –º–µ—Å—è—Ü–µ–≤. –¢–∞–∫–æ–µ –Ω–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ `–≤ –Ω–æ–ª—å`.
```
later_months_from_prev = [
        f"{month_number_to_name[(prev_dt.month + i - 1) % 12 + 1]} {prev_dt.year + ((prev_dt.month + i - 1) // 12)}"
        for i in range(1, 13)
    ]
    later_months_from_prev2 = [
        f"{month_number_to_name[(prev2_dt.month + i - 1) % 12 + 1]} {prev2_dt.year + ((prev2_dt.month + i - 1) // 12)}"
        for i in range(1, 13)
    ]
```
–í –∏—Ç–æ–≥–µ `later_months_from_prev` —Å–æ–¥–µ—Ä–∂–∏—Ç –º–µ—Å—è—Ü—ã, –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –ø–æ—Å–ª–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ, –∞ `later_months_from_prev2` ‚Äî –ø–æ—Å–ª–µ –ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ. –° –ø–æ–º–æ—â—å—é `month_number_to_name` –º—ã –ø—Ä–µ–≤—Ä–∞—â–∞–µ–º –Ω–æ–º–µ—Ä –º–µ—Å—è—Ü–∞ –≤ —Å–ª–æ–≤–æ, –∞ —Ç—É—Ç `{prev_dt.year + ((prev_dt.month + i - 1) // 12)}` –≤—ã—á–∏—Å–ª—è–µ–º —Å–∞–º –≥–æ–¥. –° –ø–æ–º–æ—â—å—é `% 12` –º—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º, —á—Ç–æ –Ω–∞—à–∏ –Ω–æ–º–µ—Ä–∞ –º–µ—Å—è—Ü–µ–≤ –±—É–¥—É—Ç –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç 1 –¥–æ 12. –ù—É –∏ —Å–∞–º–æ `i` –º—ã —Ç–æ–∂–µ –ø–µ—Ä–µ–±–∏—Ä–∞–µ–º –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç 1 –¥–æ 13. –ï—Å–ª–∏ —á—Ç–æ, —Ç–æ –º—ã —Å—Ç–∞–≤–∏–º 13 —Ç–∞–º –ø—Ä–æ—Å—Ç–æ –ø–æ—Ç–æ–º—É, —á—Ç–æ —É –Ω–∞—Å `range` –æ—Å–æ–±–µ–Ω–Ω—ã–π ‚Äî –æ–Ω –Ω–µ –±–µ—Ä–µ—Ç –≤–µ—Ä—Ö–Ω—é—é –≥—Ä–∞–Ω–∏—Ü—É –¥–∏–∞–ø–∞–∑–æ–Ω–∞, –∞ –±–µ—Ä–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ –≥—Ä–∞–Ω–∏—Ü–µ–π. 

–î–∞–ª–µ–µ –º—ã –ø–µ—Ä–µ–±–∏—Ä–∞–µ–º –≤—Å–µ –Ω–∞—à–∏ –∞–∫–∫–∞—É–Ω—Ç—ã, —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–≤ DataFrame –ø–æ –∫–æ–ª–æ–Ω–∫–µ `Account`.

```
for _, row in group.iterrows():
            # –ü—Ä–æ–ª–æ–Ω–≥–∞—Ü–∏—è –≤ 1-–π –º–µ—Å—è—Ü –ø–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è
            end_val = get_adjusted_value(row, prev_month, later_months_from_prev, '')
            next_val = get_adjusted_value(row, current_month_str, [], prev_month)
            if end_val is not None and isinstance(end_val, (int, float)) and end_val > 0:
                k1_num += next_val if isinstance(next_val, (int, float)) else 0
                k1_den += end_val

            # –ü—Ä–æ–ª–æ–Ω–≥–∞—Ü–∏—è –≤–æ 2-–π –º–µ—Å—è—Ü –ø–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è
            end2_val = get_adjusted_value(row, prev2_month, later_months_from_prev2, '')
            skip_val = get_adjusted_value(row, prev_month, later_months_from_prev, prev2_month)
            second_val = get_adjusted_value(row, current_month_str, [], prev_month)

            if end2_val is not None and isinstance(end2_val, (int, float)) and end2_val > 0 and (not skip_val or skip_val == 0):
                k2_num += second_val if isinstance(second_val, (int, float)) else 0
                k2_den += end2_val
```

–°–∞–º –ø–æ —Å–µ–±–µ —Ü–∏–∫–ª —Å–æ–±–∏—Ä–∞–µ—Ç –æ—Ç–≥—Ä—É–∑–∫–∏ –∏ –ø—Ä–æ—á–µ–µ. 

```
end_val = get_adjusted_value(row, prev_month, later_months_from_prev, '')
next_val = get_adjusted_value(row, current_month_str, [], prev_month)
```

–ì–¥–µ `end_val` –∏ `next_val` - —ç—Ç–æ –æ—Ç–≥—Ä—É–∑–∫–∏ –≤ –º–µ—Å—è—Ü –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞ –∏ –≤ –º–µ—Å—è—Ü –∞–Ω–∞–ª–∏–∑–∞. –ê `get_adjusted_value` –∏—Å–ø–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–Ω–∞—á–µ–Ω–∏–π `—Å—Ç–æ–ø` –∏ `–≤ –Ω–æ–ª—å`.  –ò –¥–∞–ª–µ–µ –µ—Å–ª–∏ —É –Ω–∞—Å –æ—Ç–≥—Ä—É–∑–∫–∞ –≤ –º–µ—Å—è—Ü –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –Ω–µ –Ω—É–ª–µ–≤–∞—è, —Ç–æ —Ç–æ–≥–¥–∞ –º—ã –∫ `k1_den` –∏ `k1_val` –ø—Ä–∏–±–∞–≤–ª—è–µ–º `end_val` –∏ `next_val` —Å–æ–æ—Ç–≤–µ—Ç—Å–≤–µ–Ω–Ω–æ. –¢–æ –µ—Å—Ç—å `k1_den` - —ç—Ç–æ —Å—É–º–º–∞ –æ—Ç–≥—Ä—É–∑–æ–∫ –≤ –º–µ—Å—è—Ü –∑–∞–≤—Ä–µ—à–Ω–∏—è (–¥–ª—è K1, —É—á–∏—Ç—ã–∞—è —á—Ç–æ –º—ã —Å—á–∏—Ç–∞–µ–º –æ—Ç –º–µ—Å—è—Ü–∞ –æ—Ç–≥—Ä—É–∑–∫–∏ —ç—Ç–æ –ø—Ä–µ–¥—ã–¥—â–∏–π –º–µ—Å—è—Ü). –ê–Ω–∞–ª–æ–≥—á–∏–Ω–æ –¥–ª—è K2, –Ω–æ —Ç—É—Ç –∂–µ –µ—Å—Ç—å –Ω—é–∞–Ω—Å. –í –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π –º–µ—Å—è—Ü –æ—Ç–≥—Ä—É–∑–æ–∫ –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å. 

```
end2_val = get_adjusted_value(row, prev2_month, later_months_from_prev2, '')
skip_val = get_adjusted_value(row, prev_month, later_months_from_prev, prev2_month)
second_val = get_adjusted_value(row, current_month_str, [], prev_month)
```

`end2_val` –∏ `second_val` - —ç—Ç–æ –æ—Ç–≥—Ä—É–∑–∫–∏ –≤ –º–µ—Å—è—Ü –∑–∞–≤–µ—Ä–µ—à–Ω–∏—è –∏ –≤–æ –≤—Ç–æ—Ä–æ–π –º–µ—Å—è—Ü –ø—Ä–æ–ª–æ–Ω–≥–∞—Ü–∏–∏. –ê –≤–æ–æ—Ç `skip_val` –ø–æ–∑–≤–æ–ª–∏—Ç –Ω–∞–º –ø–æ–Ω—è—Ç—å, –µ—Å—Ç—å –ª–∏ –≤ –ø–µ—Ä–≤—ã–π –º–µ—Å—è—Ü –ø—Ä–æ–ª–æ–Ω–≥–∞—Ü–∏–∏ –æ—Ç–≥—Ä—É–∑–∫–∞

```
if end2_val is not None and isinstance(end2_val, (int, float)) and end2_val > 0 and (not skip_val or skip_val == 0):
                k2_num += second_val if isinstance(second_val, (int, float)) else 0
                k2_den += end2_val
```

–ò –µ—Å–ª–∏ —É –Ω–∞—Å `skip_val` –Ω—É–ª–µ–≤–æ–π, –∞ `end2_val` (—Ç–æ –µ—Å—Ç—å –æ—Ç–≥—Ä—É–∑–∫–∞ –≤ –º–µ—Å—è—Ü –∑–∞—ã–≤–µ—Ä—à–µ–Ω–∏—è) –Ω–µ –Ω—É–ª–µ–≤–æ–π, —Ç–æ —Ç–æ–≥–¥–∞ –º—ã —Å—á–∏—Ç–∞–µ–º —Å—É–º–º—ã –æ—Ç–≥—Ä—É–∑–∫–∏ –≤ –º–µ—Å—è—Ü –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏ –≤–æ –≤—Ç–æ—Ä–æ–π –º–µ—Å—è—Ü –ø—Ä–æ–ª–æ–Ω–≥–∞—Ü–∏–∏. `k2_num`  –∏ `k2_den` - z—ç—Ç–æ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ `k1_num` –∏ `k2_val` —Å–æ–æ—Ç–≤–µ—Å—Ç–≤–µ–Ω–Ω–æ. 

–î–∞–ª–µ–µ –≤—ã—á–∏—Å–ª—è–µ–º –Ω–∞—à–∏ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞

```
k1 = round(k1_num / k1_den, 2) if k1_den else None
k2 = round(k2_num / k2_den, 2) if k2_den else None
```
–ù–æ —è —Ç—É—Ç –æ—Ç —Å–µ–±—è –¥–æ–±–∞–≤–∏–ª –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π –ø—Ä–æ–≤–µ—Ä–∫—É, —á—Ç–æ `k1_den` –∏ `k2_den` –Ω–µ –ø—É—Å—Ç—ã–µ, —á—Ç–æ –Ω–µ –±—ã–ª–æ –æ—à–∏–±–æ–∫ –¥–µ–ª–µ–Ω–∏—è –Ω–∞ 0.

```
 coefficients.append({
            'Account': account,
            'K1': k1,
            'K2': k2
        })
```

–ó–∞–∫–∏–¥—ã–≤—É—é —ç—Ç–æ –≤ —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏–π —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞, —á—Ç–æ–±—ã –ø–æ—Ç–æ–º –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –≤ Data Frame

```
 return pd.DataFrame(coefficients)
```

–í–æ—Ç –∏ –≤–µ—Å—å –æ—Å–Ω–æ–≤–Ω–æ –∞–ª–æ–≥—Ä–∏—Ç–º. –¢—É—Ç –≥–ª–∞–≤–Ω–æ–µ –±—ã–ª–æ –ø–æ–Ω—è—Ç—å –≤ —Å–∞–º–æ–π –∑–∞–¥–∞—á–µ, –∫–∞–∫ –≤—ã—á–∏—Å–ª—è—Ç—å —ç—Ç–∏ K1 –∏ K2.


–ù—É –¥–∞–ª—å—à–µ –Ω–∞–º –æ—Å—Ç–∞–µ—Ç—Å—è –≤—ã–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –º–µ—Å—è—Ü–µ–≤ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –ø—Ä–æ–ª–æ–Ω–≥–∞—Ü–∏–∏ `df_prolong` –ò —É–∂–µ –ø–µ—Ä–µ–±–∏—Ä–∞—è –∏—Ö –ø–æ–¥—Å—Ç–∞–≤–ª—è—Ç—å –≤ –Ω–∞—à—É —Ñ—É–Ω–∫—Ü–∏—é –≤—ã—á–∏—Å–ª–µ–Ω–∏—è. –ê —Ç–∞–º –µ—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ –ø—É—Å—Ç–æ–≤, —Ç–æ –∑–∞–ø–∏—Å—ã–≤–∞–µ–º –≤ –º–∞—Å—Å–∏–≤ result.

```
# –°–ø–∏—Å–æ–∫ –º–µ—Å—è—Ü–µ–≤
months_to_analyze = sorted(set(df_prolong['month']))

# –†–∞—Å—á—ë—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤
results = []
for month in months_to_analyze:
    coeffs_df = calculate_coefficients(merged, month)
    if not coeffs_df.empty:
        results.extend(coeffs_df.to_dict(orient='records'))
```
### –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤

–û—Ç—á–µ—Ç—ã —è —Ñ–æ—Ä–º–∏—Ä—É—é –≤ 4-—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö: `overall_report.csv` - –æ—Ç—á–µ—Ç –ø–æ –∫–∞–∂–¥–æ–º—É –º–µ–Ω–µ–¥–∂–µ—Ä—É –∑–∞ –≤–µ—Å—å –ø–µ—Ä–∏–æ–¥, –∞ `yearly_report.csv` - –≥–æ–¥–æ–≤–æ–π –æ—Ç—á–µ—Ç –ø–æ –∫–∞–∂–¥–æ–º—É –º–µ–Ω–µ–¥–∂–µ—Ä—É, —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ –≥–æ–¥–∞–º, `prolongation_report_fixed.csv` - —ç—Ç–æ –æ—Å–Ω–æ–≤–Ω–æ–π –æ—Ç—á–µ—Ç –ø–æ –∫–∞–∂–¥–æ–º—É –º–µ—Å—è—Ü—É –∏ –º–µ–Ω–µ–¥–∂–µ—Ä—É, –∞ `department_summary.csv` - —ç—Ç–æ –æ–±—â–∏–π –æ—Ç—á–µ—Ç –ø–æ –≤—Å–µ–º—É –æ—Ç–¥–µ–ª—É.


```
final_df = pd.DataFrame(results)

final_df['–ì–æ–¥'] = final_df['–ú–µ—Å—è—Ü'].str.extract(r'(\d{4})')
yearly_report = final_df.groupby(['–ì–æ–¥', '–ú–µ–Ω–µ–¥–∂–µ—Ä'])[['K1', 'K2']].mean().reset_index()
overall_report = final_df.groupby('–ú–µ–Ω–µ–¥–∂–µ—Ä')[['K1', 'K2']].mean().reset_index()

overall_summary = pd.DataFrame({
    '–ú–µ–Ω–µ–¥–∂–µ—Ä': ['–í–µ—Å—å –æ—Ç–¥–µ–ª'],
    'K1': [final_df['K1'].mean(skipna=True)],
    'K2': [final_df['K2'].mean(skipna=True)]
})

final_df.to_csv('prolongation_report_fixed.csv', index=False)
yearly_report.to_csv('yearly_report.csv', index=False)
overall_report.to_csv('overall_report.csv', index=False)
overall_summary.to_csv('department_summary.csv', index=False)

print("–í—Å–µ –æ—Ç—á—ë—Ç—ã —É—Å–ø–µ—à–Ω–æ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω—ã –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ CSV!")
print("–ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö:")
print(final_df.head())
```
–î–ª—è –±–æ–ª—å—à–µ–≥–æ —É–¥–æ–±—Å—Ç–≤–∞, —è –≤—Ä—É—á–Ω—É—é —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–ª –æ–¥–Ω—É —Ç–∞–±–ª–∏—Ü—É `–û–±—â–∏ –æ—Ç—á–µ—Ç –≤—Å–µ–≥–æ` - –≥–¥–µ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –≤—Å–µ—Ö 4-—Ö —Ñ–∞–π–ª–æ–≤ —Å–æ–±—Ä–∞–Ω—ã –≤ –æ–¥–∏–Ω —Ñ–∞–π–ª, –Ω–æ –ø–æ —Ä–∞–∑–Ω—ã–º –ª–∏—Å—Ç–∞–º. 

# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è "–û—Ç–∫—Ä—ã—Ç–∏–µ —Ñ–∞–π–ª–∞ csv –≤ excel"

–£ –º–Ω–æ–≥–∏—Ö –≤–æ–∑–Ω–∏–∫–∞—é—Ç –≤–æ–ø—Ä–æ—Å—ã, –∞ –∫–∞–∫ –æ—Ç–∫—Ä—ã—Ç—å `csv` –≤ `Excel`. –õ–µ–≥–∫–æ –∏ –ø—Ä–æ—Å—Ç–æ! –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –º–æ–∂–µ—Ç –ø—Ä–æ–∏–∑–æ–π—Ç–∏ —Ç–∞–∫, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –≤ –æ–¥–Ω–æ–π –∫–æ–ª–æ–Ω–∫–µ. –ù–æ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –∑–Ω–∞–∫–∞–º–∏-—Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è–º–∏. –ß–∞—â–µ –≤—Å–µ–≥–æ `;` ‚Äî —ç—Ç–æ –∑–Ω–∞–∫-—Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å, –Ω–æ –º–æ–≥—É—Ç –±—ã—Ç—å –∑–∞–ø—è—Ç—ã–µ. –ß—Ç–æ–± –≤—Å—ë —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –º—ã –Ω–∞–∂–∏–º–∞–µ–º –Ω–∞ `–î–∞–Ω–Ω—ã–µ` –Ω–∞ –ø–∞–Ω–µ–ª–∏ –≤–∫–ª–∞–¥–æ–∫, –∞ –ø–æ—Ç–æ–º –Ω–∞—Ö–æ–¥–∏–º `–¢–µ–∫—Å—Ç –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º`. –î–∞–ª—å—à–µ –º—ã –≤—ã–±–∏—Ä–∞–µ–º `—Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º` -> `–û–ö`. –ê –ø–æ—Ç–æ–º –≤—ã–±–∏—Ä–∞–µ–º —Ç–∏–ø —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è –∑–Ω–∞–∫–∞. –ñ–º—ë–º `–û–ö`, –∞ –∑–∞—Ç–µ–º `–ì–æ—Ç–æ–≤–æ`. 

–¢–æ –∂–µ —Å–∞–º–æ–µ –ø—Ä–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏ csv –≤ Excel. –í—Å—ë –≤—Å—Ç–∞–≤–∏—Ç—Å—è –≤ –æ–¥–Ω—É –∫–æ–ª–æ–Ω–∫—É, –∞ –¥–∞–ª—å—à–µ –¥–µ–ª–∞–π —Ç–æ –∂–µ —Å–∞–º–æ–µ.

# –í—ã–≤–æ–¥

–í—ã–ø–æ–ª–Ω—è—è —ç—Ç—É –∑–∞–¥–∞—á—É, –º–Ω–µ —É–¥–∞–ª–æ—Å—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç —Å–∞–º–∞ –≤—ã—á–∏—Å–ª—è—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –ø—Ä–æ–ª–æ–Ω–≥–∞—Ü–∏–∏ –∫–∞–∂–¥–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞. –¢–∞–∫–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∏ –≤–ø—Ä–∞–≤–¥—É –ø–æ–º–æ–∂–µ—Ç —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤—É –≤—ã—è–≤–ª—è—Ç—å –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤. 

–°–ø–∞—Å–∏–±–æ, —á—Ç–æ –∑–∞—à–µ–ª –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–∞–Ω–Ω—ã–π –∫–æ–¥. –Ø –Ω–∞–¥–µ—é—Å—å, —á—Ç–æ —Ç–µ–±–µ –±—ã–ª–æ –≤—Å–µ —è—Å–Ω–æ. –ú–æ–∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å –Ω–∞ –º–æ–µ–º –ø—Ä–æ—Ñ–∏–ª–µ!

–£–¥–∞—á–∏!
